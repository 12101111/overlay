From 2284c40613c77ba37bb738ddb30bc887a5b55d6d Mon Sep 17 00:00:00 2001
From: 12101111 <w12101111@gmail.com>
Date: Sat, 9 Jan 2021 02:23:02 +0800
Subject: [PATCH 2/2] Don't build in-tree llvm-libunwind if
 system-llvm-libunwind is enable

---
 library/unwind/build.rs | 4 ++++
 1 file changed, 4 insertions(+)

diff --git a/library/unwind/build.rs b/library/unwind/build.rs
index 24bcd40c3a8..5c486d2a7e3 100644
--- a/library/unwind/build.rs
+++ b/library/unwind/build.rs
@@ -4,6 +4,10 @@ fn main() {
     println!("cargo:rerun-if-changed=build.rs");
     let target = env::var("TARGET").expect("TARGET was not set");
 
+    if cfg!(feature = "system-llvm-libunwind") {
+        return;
+    }
+
     if cfg!(feature = "llvm-libunwind")
         && ((target.contains("linux") && !target.contains("musl")) || target.contains("fuchsia"))
     {
-- 
2.30.0

